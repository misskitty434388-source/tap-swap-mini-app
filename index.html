<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tap Swap All-in-One</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü -->
    <script src='https://libtl.com/sdk.js' data-zone='10542570' data-sdk='show_10542570'></script>

    <style>
        body { background-color: #0f0f1a; color: white; font-family: sans-serif; margin: 0; padding: 0; text-align: center; overflow-x: hidden; }
        
        /* ‡¶®‡ßç‡¶Ø‡¶æ‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ‡¶Æ‡ßá‡¶®‡ßÅ */
        .nav { position: fixed; bottom: 0; width: 100%; background: #1a1a2e; display: flex; justify-content: space-around; padding: 15px 0; border-top: 2px solid #00ff88; z-index: 1000; }
        .nav-btn { background: none; border: none; color: #888; font-size: 16px; font-weight: bold; cursor: pointer; }
        .nav-btn.active { color: #00ff88; }

        /* ‡¶∏‡ßá‡¶ï‡¶∂‡¶® ‡¶ó‡ßÅ‡¶≤‡ßã */
        .page { display: none; padding: 20px; padding-bottom: 80px; height: 100vh; box-sizing: border-box; }
        .active-page { display: flex; flex-direction: column; align-items: center; justify-content: center; }

        h1 { color: #00ff88; }
        .card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; width: 80%; margin: 10px auto; border: 1px solid #444; }
        
        /* Spin Wheel Design */
        #wheel-con { position: relative; width: 200px; height: 200px; margin: 20px auto; }
        #wheel { width: 100%; height: 100%; border-radius: 50%; border: 5px solid #ffcc00; transition: transform 3s cubic-bezier(0.25, 0.1, 0.25, 1); background: conic-gradient(#ff0055 0% 33%, #00ff88 33% 66%, #00ccff 66% 100%); }
        #marker { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 20px solid white; z-index: 10; }
        
        /* ‡¶¨‡¶æ‡¶ü‡¶® ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .btn-action { background: #00ff88; color: #000; padding: 10px 25px; border: none; border-radius: 20px; font-weight: bold; font-size: 18px; cursor: pointer; margin-top: 20px; }
        .btn-action:disabled { background: #555; color: #888; }

        iframe { width: 100%; border-radius: 10px; border: 2px solid #444; }
    </style>
</head>
<body>

    <!-- 1. TASK PAGE (Timer) -->
    <div id="page-task" class="page active-page">
        <h1>‚è≥ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞</h1>
        <p>‡ß©‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶®‡¶ø‡¶®</p>
        <div class="card">
            <h2 id="timer">30</h2>
            <p id="task-status">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</p>
        </div>
        <button id="btn-claim-task" class="btn-action" style="display:none;" onclick="claimTask()">‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ ‡¶®‡¶ø‡¶®</button>
    </div>

    <!-- 2. SPIN PAGE -->
    <div id="page-spin" class="page">
        <h1>üé° ‡¶≤‡¶æ‡¶ï‡¶ø ‡¶∏‡ßç‡¶™‡¶ø‡¶®</h1>
        <p>‡¶ö‡¶æ‡¶ï‡¶æ ‡¶ò‡ßÅ‡¶∞‡¶ø‡ßü‡ßá ‡¶ú‡¶ø‡¶§‡ßá ‡¶®‡¶ø‡¶® ‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞</p>
        <div id="wheel-con">
            <div id="marker"></div>
            <div id="wheel"></div>
        </div>
        <button id="btn-spin" class="btn-action" onclick="startSpin()">SPIN</button>
        <p id="spin-result" style="margin-top:10px;"></p>
    </div>

    <!-- 3. VIDEO PAGE -->
    <div id="page-video" class="page">
        <h1>üì∫ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</h1>
        <p>‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶ü‡¶ø ‡ßß‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</p>
        <div class="card">
            <!-- ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ü‡¶ø‡¶â‡¶¨ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¶‡¶ø‡¶® -->
            <iframe id="video-frame" height="200" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allowfullscreen></iframe>
        </div>
        <button id="btn-video-claim" class="btn-action" disabled onclick="claimVideo()">‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ ‡¶®‡¶ø‡¶® (Wait 10s)</button>
    </div>

    <!-- ‡¶®‡ßç‡¶Ø‡¶æ‡¶≠‡¶ø‡¶ó‡ßá‡¶∂‡¶® ‡¶Æ‡ßá‡¶®‡ßÅ -->
    <div class="nav">
        <button class="nav-btn active" onclick="switchPage('task', this)">‚è≥ ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</button>
        <button class="nav-btn" onclick="switchPage('spin', this)">üé° ‡¶∏‡ßç‡¶™‡¶ø‡¶®</button>
        <button class="nav-btn" onclick="switchPage('video', this)">üì∫ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        try { if (typeof show_10542570 === 'function') show_10542570(); } catch(e){}

        // --- PAGE SWITCHING ---
        function switchPage(pageId, btn) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.getElementById('page-' + pageId).classList.add('active-page');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        // --- 1. TASK LOGIC ---
        let taskTime = 30;
        let taskTimer = setInterval(() => {
            if(document.getElementById('page-task').classList.contains('active-page')){
                taskTime--;
                document.getElementById('timer').innerText = taskTime;
                if(taskTime <= 0) {
                    clearInterval(taskTimer);
                    document.getElementById('timer').innerText = "‚úî";
                    document.getElementById('task-status').innerText = "‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!";
                    document.getElementById('btn-claim-task').style.display = "block";
                }
            }
        }, 1000);

        function claimTask() {
            tg.sendData("TASK_REWARD_5"); // 5 ‡¶ü‡¶æ‡¶ï‡¶æ
            tg.close();
        }

        // --- 2. SPIN LOGIC ---
        function startSpin() {
            let wheel = document.getElementById('wheel');
            let deg = Math.floor(5000 + Math.random() * 5000); // Random Rotation
            wheel.style.transform = `rotate(${deg}deg)`;
            
            document.getElementById('btn-spin').disabled = true; // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶≤‡¶ï
            
            setTimeout(() => {
                let prizes = [2, 5, 10]; // ‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ
                let win = prizes[Math.floor(Math.random() * prizes.length)];
                document.getElementById('spin-result').innerText = `‡¶Ü‡¶™‡¶®‡¶ø ‡¶ú‡¶ø‡¶§‡ßá‡¶õ‡ßá‡¶® ${win} ‡¶ü‡¶æ‡¶ï‡¶æ!`;
                
                setTimeout(() => {
                    tg.sendData("SPIN_REWARD_" + win); // ‡¶¨‡¶ü‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá
                    tg.close();
                }, 2000);
            }, 3000);
        }

        // --- 3. VIDEO LOGIC ---
        let videoTime = 10;
        let videoBtn = document.getElementById('btn-video-claim');
        
        // ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßá‡¶ú‡ßá ‡¶ó‡ßá‡¶≤‡ßá ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá
        setInterval(() => {
            if(document.getElementById('page-video').classList.contains('active-page') && videoTime > 0) {
                videoTime--;
                videoBtn.innerText = `‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® (${videoTime}s)`;
                if(videoTime <= 0) {
                    videoBtn.innerText = "‡¶™‡ßÅ‡¶∞‡¶∏‡ßç‡¶ï‡¶æ‡¶∞ ‡¶®‡¶ø‡¶®";
                    videoBtn.disabled = false;
                    videoBtn.style.background = "#ff0055";
                    videoBtn.style.color = "white";
                }
            }
        }, 1000);

        function claimVideo() {
            tg.sendData("VIDEO_REWARD_3"); // 3 ‡¶ü‡¶æ‡¶ï‡¶æ
            tg.close();
        }
    </script>
</body>
</html>
